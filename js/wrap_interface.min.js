var detectMetamask=!1,metamaskConnected=!1,userAddress="",contract_viewallowance="dd62ed3e",contract_approve="095ea7b3",contract_totalsupply="18160ddd",contract_balanceof="70a08231",contract_deposit="b6b55f25",contract_deposit_multi="e2bbb158",contract_redeem="db006a75",contract_tokenprice="7b1b1de6",contract_getlastbalance="3303b8ab",contract_view_withdrawtoken="c650ea59",contract_calcfee="4d607fb2",contract_value="563a7956",contract_locked="d135cc4b",contract_strategy="83249ef9",contract_tokenprice_last="bfe78433",contract_strat_liquidity="43e4cb17",targetNetwork=42161,tokenList=[],tokenRotation=0;function loadTokenList(){(e=[])[0]={token:"0x1aDDD80E6039594eE970E5872D247bf0414C8903",decimals:18,symbol:"GLP"},tokenList.push({zToken:"0xA4373B079cf2689094C4cCE148aa04948666A361",underlying:"0x1aDDD80E6039594eE970E5872D247bf0414C8903",approveToken:"0x01AF26b74409d10e15b102621EDd29c326ba1c55",withdrawTokens:e,units:"zs-fsGLP",underlyingUnits:"GLP",decimals:18,panel:"3",tokenType:1,checkpointTime:new BigNumber(1657636285),checkpointPrice:new BigNumber("1.712033215339787957")}),(e=[])[0]={token:"0xFF970A61A04b1cA14834A43f5dE4533eBDDB5CC8",decimals:6,symbol:"USDC"},tokenList.push({zToken:"0x3B308089b9271a5B90Bf8C8B6959C2745C386CD5",underlying:"0xFF970A61A04b1cA14834A43f5dE4533eBDDB5CC8",withdrawTokens:e,units:"zs-imUSDC",underlyingUnits:"USDC",decimals:18,panel:"5",tokenType:2,checkpointTime:new BigNumber(-1),checkpointPrice:new BigNumber("1.024666338532576741")}),(e=[])[0]={token:"0x82aF49447D8a07e3bd95BD0d56f35241523fBab1",decimals:18,symbol:"WETH"},tokenList.push({zToken:"0x8ebF70E10aDF6933b7cDD138FEfB0C3fD3Ae586A",underlying:"0x82aF49447D8a07e3bd95BD0d56f35241523fBab1",withdrawTokens:e,units:"zs-imWETH",underlyingUnits:"WETH",decimals:18,panel:"6",tokenType:2,checkpointTime:new BigNumber(-1),checkpointPrice:new BigNumber("1.020501519473321417")}),(e=[])[0]={token:"0x7f90122BF0700F9E7e1F688fe926940E8839F353",decimals:18,symbol:"2CRV"},tokenList.push({zToken:"0xC6fEe0D765dd0E14EF55f6eBE82A5780bbb3735f",underlying:"0x7f90122BF0700F9E7e1F688fe926940E8839F353",withdrawTokens:e,units:"zs-2CRV",underlyingUnits:"2CRV",decimals:18,panel:"1",tokenType:0,checkpointTime:new BigNumber(-1),checkpointPrice:new BigNumber("1.026927481289457024")}),(e=[])[0]={token:"0x2f2a2543B76A4166549F7aaB2e75Bef0aefC5B0f",decimals:8,symbol:"wBTC"},e[1]={token:"0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9",decimals:6,symbol:"USDT"},tokenList.push({zToken:"0xa871660281D720DB65A1E31E4C2e820b6Fb47351",underlying:"0x2f2a2543B76A4166549F7aaB2e75Bef0aefC5B0f",withdrawTokens:e,units:"zst-wBTC",underlyingUnits:"wBTC",decimals:18,panel:"4",tokenType:0,checkpointTime:new BigNumber(-1),checkpointPrice:new BigNumber(1)});var e=[];e[0]={token:"0xFEa7a6a0B346362BF88A9e4A88416B77a57D6c2A",decimals:18,symbol:"MIM"},e[1]={token:"0xFF970A61A04b1cA14834A43f5dE4533eBDDB5CC8",decimals:6,symbol:"USDC"},e[2]={token:"0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9",decimals:6,symbol:"USDT"},tokenList.push({zToken:"0x1017E68aEcB51Fb46093f064Fa7c177757B7125E",underlying:"0xFEa7a6a0B346362BF88A9e4A88416B77a57D6c2A",withdrawTokens:e,units:"zs-MIM",underlyingUnits:"MIM",decimals:18,panel:"0",tokenType:0,checkpointTime:new BigNumber(-1),checkpointPrice:new BigNumber("1.039922393481557398")}),(e=[])[0]={token:"0x82aF49447D8a07e3bd95BD0d56f35241523fBab1",decimals:18,symbol:"WETH"},tokenList.push({zToken:"0x75A2a05B8A21568f5e052b6bbCfB799624Fb2d8E",underlying:"0x82aF49447D8a07e3bd95BD0d56f35241523fBab1",withdrawTokens:e,units:"zs-WETH",underlyingUnits:"WETH",decimals:18,panel:"2",tokenType:0,checkpointTime:new BigNumber(-1),checkpointPrice:new BigNumber(1.000903)})}function checkMetaMaskExist(){void 0!==window.ethereum&&(detectMetamask=!0,null==getCookie("metamask")?$("#metamask_interactive").html("Connect Wallet"):0==metamaskConnected&&enableMetaMask())}$(window).on("load",function(){checkMetaMaskExist()});async function enableMetaMask(){var e=await ethereum.request({method:"eth_requestAccounts"});if(e){var t=await ethereum.request({method:"eth_chainId"});if(0!=(t=new BigNumber("0x"+t.substring(2))).comparedTo(targetNetwork))return 0==t.comparedTo(56)?void window.location.replace("../../"):0==t.comparedTo(1)?(userAddress=e[0],$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),$("#connection_text").html('Switch network from Ethereum network to <a href="https://developer.offchainlabs.com/docs/mainnet#connect-your-wallet" target="_blank">Arbitrum One</a> network<br><a style="font-size: 12px;" href="../../deprecated-v1/wrap/">View deprecated Ethereum wraps</a>'),void ethereum.on("chainChanged",function(e){location.reload()})):void alert("This application requires the Arbitrum One network, please switch it in your MetaMask UI.");userAddress=e[0],metamaskConnected=!0,setCookie("metamask","active",0),$("#loading_panel").hide(),$("#data_panel").show(),refreshTokenData(!0),$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),ethereum.on("accountsChanged",function(e){userAddress=e[0],$("#metamask_interactive").html(userAddress.substring(0,9)+"..."+userAddress.substring(33)),location.reload()}),ethereum.on("chainChanged",function(e){location.reload()})}}function metamaskButtonClick(){0==detectMetamask?window.open("https://metamask.io/","_blank"):1==detectMetamask&&0==metamaskConnected&&enableMetaMask()}function padleftzero(e,t){return(e=e.toString()).length<t?padleftzero("0"+e,t):e}function padrightzero(e,t){return(e=e.toString()).length<t?padrightzero(e+"0",t):e}function showInactiveWraps(){$("#inactive_wraps_controller").html("INACTIVE WRAPS"),$("#inactive_wraps_container").show()}async function getStrategyGrowthRate(e){var t,n,o=tokenList[e].zToken,i=tokenList[e].checkpointTime;i.comparedTo(0)<0?$("#panel_"+tokenList[e].panel+"_apy").html("N/A"):0!=i.comparedTo(0)&&((t=new BigNumber(Math.floor((new Date).getTime()/1e3))).minus(43200).comparedTo(i)<0||(o=[{to:o,data:"0x"+contract_tokenprice},"latest"],await ethereum.request({method:"eth_call",params:o}).then(e=>{e=e.substring(2);n=new BigNumber("0x"+e.substring(0,64))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),o=tokenList[e].checkpointPrice.times(new BigNumber(10).pow(18)),o=n.div(o).minus(1),i=t.minus(i).div(86400),0<(i=o.div(i).times(100).times(365)).comparedTo(1e-5)&&$("#panel_"+tokenList[e].panel+"_apy").html(i.dp(4).toString(10)+"%")))}function updateMultiCoinPanel(e){for(var t=$(e).attr("id"),n=-1,o=0;o<tokenList.length;o++)if("panel_"+tokenList[o].panel+"_deposit_account"==t.toLowerCase()){n=o;break}-1!=n&&($("#panel_"+tokenList[n].panel+"_action_buttons").hide(),$("#panel_"+tokenList[n].panel+"_unlock_button").hide(),$("#panel_"+tokenList[n].panel+"_unlock_inner_button").prop("disabled",!1),$("#panel_"+tokenList[n].panel+"_unlock_inner_button").html("UNLOCK WRAPPER"),checkAllowance(n))}function checkAllowance(e){var t,n=tokenList[e].panel;0==tokenList[e].tokenType||2==tokenList[e].tokenType?t=tokenList[e].underlying:1==tokenList[e].tokenType&&(t=tokenList[e].approveToken);tokenList[e].zToken;var o=padleftzero(userAddress.substring(2),64),e=padleftzero(tokenList[e].zToken.substring(2),64);("none"==$("#panel_"+n+"_action_buttons").css("display")&&"none"==$("#panel_"+n+"_unlock_button").css("display")||1==$("#panel_"+n+"_unlock_inner_button").prop("disabled"))&&(e=[{to:t,data:"0x"+contract_viewallowance+o+e},"latest"],ethereum.request({method:"eth_call",params:e}).then(e=>{e=e.substring(2);new BigNumber("0x"+e.substring(0,64)).comparedTo(1)<0?$("#panel_"+n+"_unlock_button").show():($("#panel_"+n+"_unlock_button").hide(),$("#panel_"+n+"_action_buttons").show())}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}))}async function refreshTokenData(e){if(0==tokenList.length&&loadTokenList(),0==tokenRotation)window.setTimeout(function(){refreshTokenData(!0)},6e4);else if(1==e)return void window.setTimeout(function(){refreshTokenData(!0)},6e4);var i,t,a,n,r,s;0!=tokenList.length&&(i=tokenList[tokenRotation].panel,t=tokenList[tokenRotation].zToken,e=padleftzero(userAddress.substring(2),64),checkAllowance(tokenRotation),0!=tokenList[tokenRotation].tokenType&&1!=tokenList[tokenRotation].tokenType&&2!=tokenList[tokenRotation].tokenType||getStrategyGrowthRate(tokenRotation),a=tokenRotation,e=[{to:t,data:"0x"+contract_balanceof+e},"latest"],r=3,await ethereum.request({method:"eth_call",params:e}).then(e=>{e=e.substring(2);(n=(n=new BigNumber("0x"+e.substring(0,64))).div(new BigNumber(10).pow(tokenList[a].decimals))).comparedTo("0.001")<0&&(r=10),$("#panel_"+i+"_walletbalance").html(n.dp(r).toString(10)+" "+tokenList[a].units)}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),e=[{to:t,data:"0x"+contract_tokenprice},"latest"],await ethereum.request({method:"eth_call",params:e}).then(e=>{e=e.substring(2),e=(e=new BigNumber("0x"+e.substring(0,64))).div(new BigNumber(10).pow(18));$("#panel_"+i+"_price").html(e.toFormat(6)+" "+tokenList[a].underlyingUnits),s=e.times(n),$("#panel_"+i+"_value").html(s.dp(r).toString(10)+" "+tokenList[a].underlyingUnits)}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),e=[{to:t,data:"0x"+contract_view_withdrawtoken},"latest"],await ethereum.request({method:"eth_call",params:e}).then(e=>{for(var t=e.substring(2).substring(0,64).toLowerCase(),n="NONE",o=0;o<tokenList[a].withdrawTokens.length;o++)t==padleftzero(tokenList[a].withdrawTokens[o].token.substring(2).toLowerCase(),64)&&(n=tokenList[a].withdrawTokens[o].symbol);"zst-wBTC"==tokenList[a].units&&"USDT"==n&&(n="wBTC"),$("#panel_"+i+"_withdrawtoken").html(n),"NONE"!=n&&$("#panel_"+i+"_value").html(s.dp(r).toString(10)+" "+n)}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),++tokenRotation>=tokenList.length?tokenRotation=0:window.setTimeout(function(){refreshTokenData(!1)},500))}function unlockWrapper(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o,i=new BigNumber(2).pow(256).minus(1),a=padleftzero((a=tokenList[t].zToken.substring(2)).toLowerCase(),64),i=padleftzero(i=i.toString(16),64);0==tokenList[t].tokenType||2==tokenList[t].tokenType?o=tokenList[t].underlying:1==tokenList[t].tokenType&&(o=tokenList[t].approveToken),sendETHTransaction([{to:o,from:userAddress,data:"0x"+contract_approve+a+i}],function(){$("#panel_"+e+"_unlock_inner_button").prop("disabled",!0),$("#panel_"+e+"_unlock_inner_button").html("UNLOCKING WRAPPER")})}function selectMaxWrap(n){for(var o=0,e=0;e<tokenList.length;e++)if(parseInt(tokenList[e].panel)==n){o=e;break}var t,i=padleftzero(userAddress.substring(2),64);0!=tokenList[o].tokenType&&1!=tokenList[o].tokenType&&2!=tokenList[o].tokenType||(t=tokenList[o].underlying);i=[{to:t,data:"0x"+contract_balanceof+i},"latest"];ethereum.request({method:"eth_call",params:i}).then(e=>{var t=e.substring(2),e=new BigNumber("0x"+t.substring(0,64)),t=tokenList[o].decimals,t=tokenList[o].withdrawTokens[0].decimals,e=e.div(new BigNumber(10).pow(t));$("#panel_"+n+"_amount").val(e.toString(10))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function selectMaxUnwrap(t){for(var n=0,e=0;e<tokenList.length;e++)if(parseInt(tokenList[e].panel)==t){n=e;break}var o=padleftzero(userAddress.substring(2),64),o=[{to:tokenList[n].zToken,data:"0x"+contract_balanceof+o},"latest"];ethereum.request({method:"eth_call",params:o}).then(e=>{e=e.substring(2),e=(e=new BigNumber("0x"+e.substring(0,64))).div(new BigNumber(10).pow(tokenList[n].decimals));$("#panel_"+t+"_amount").val(e.toString(10))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))})}function wrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o,i,a=new BigNumber($("#panel_"+e+"_amount").val());a.isNaN()||a.comparedTo(0)<=0||(o=tokenList[t].decimals,0!=tokenList[t].tokenType&&1!=tokenList[t].tokenType&&2!=tokenList[t].tokenType||(o=tokenList[t].withdrawTokens[0].decimals),a=padleftzero(a=(a=a.times(new BigNumber(10).pow(o)).dp(0)).toString(16),64),0!=tokenList[t].tokenType&&1!=tokenList[t].tokenType&&2!=tokenList[t].tokenType||(i="0x"+contract_deposit+a),sendETHTransaction([{to:tokenList[t].zToken,from:userAddress,data:i}],null))}async function checkGMXUnlocked(e){var e=[{to:tokenList[e].zToken,data:"0x"+contract_locked},"latest"],t=!1;return await ethereum.request({method:"eth_call",params:e}).then(e=>{e=e.substring(2);0==new BigNumber("0x"+e.substring(0,64)).comparedTo(0)?t=!0:alert("This action is currently unavailable due to GMX cooldown transfer lock. Please check back in 15 minutes.")}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),t}async function checkImpermaxLiquidity(t,e){var n=[{to:tokenList[t].zToken,data:"0x"+contract_tokenprice_last},"latest"],o=new BigNumber(0);if(await ethereum.request({method:"eth_call",params:n}).then(e=>{e=e.substring(2);o=(o=new BigNumber("0x"+e.substring(0,64))).div(new BigNumber(10).pow(18))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),0==o.comparedTo(0))return!1;n=[{to:tokenList[t].zToken,data:"0x"+contract_strategy},"latest"];var i="";if(await ethereum.request({method:"eth_call",params:n}).then(e=>{e=e.substring(2);0!=new BigNumber("0x"+e.substring(0,64)).comparedTo(0)&&(i="0x"+e.substring(e.length-40))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),0==i.length)return!0;n=[{to:i=i.toLowerCase(),data:"0x"+contract_strat_liquidity},"latest"];var a=0;await ethereum.request({method:"eth_call",params:n}).then(e=>{e=e.substring(2);a=(a=new BigNumber("0x"+e.substring(0,64))).div(new BigNumber(10).pow(tokenList[t].withdrawTokens[0].decimals))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),n=[{to:tokenList[t].zToken,data:"0x"+contract_tokenprice},"latest"];var r=new BigNumber(0);if(await ethereum.request({method:"eth_call",params:n}).then(e=>{e=e.substring(2);r=(r=new BigNumber("0x"+e.substring(0,64))).div(new BigNumber(10).pow(18))}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}),0==r.comparedTo(0))return!1;n=r.div(o),a=a.times(n).times(1.0001);if(0<(e=e.times(r)).comparedTo(a)){e=a.div(r);return alert("Not enough liquidity to withdraw this amount. Select at most "+e.dp(4).toString(10)+" "+tokenList[t].units),!1}return!0}async function unwrap(e){for(var t=0,n=0;n<tokenList.length;n++)if(parseInt(tokenList[n].panel)==e){t=n;break}var o=new BigNumber($("#panel_"+e+"_amount").val());if(!(o.isNaN()||o.comparedTo(0)<=0)){if(2==tokenList[t].tokenType)if(0==await checkImpermaxLiquidity(t,o))return;o=padleftzero(o=(o=o.times(new BigNumber(10).pow(tokenList[t].decimals))).toString(16),64);if(1==tokenList[t].tokenType)if(0==await checkGMXUnlocked(t))return;sendETHTransaction([{to:tokenList[t].zToken,from:userAddress,data:"0x"+contract_redeem+o}],null)}}async function sendETHTransaction(e,t){var n=await ethereum.request({method:"eth_chainId"});0==(n=new BigNumber("0x"+n.substring(2))).comparedTo(targetNetwork)?ethereum.request({method:"eth_sendTransaction",params:e}).then(e=>{console.log("Transaction hash: "+e),t&&t()}).catch(e=>{console.log("An error occurred while pinging blockchain: "+JSON.stringify(e))}):alert("This application requires the main network, please switch it in your MetaMask UI.")}function setCookie(e,t,n){var o,i="";0<n&&((o=new Date).setTime(o.getTime()+24*n*60*60*1e3),i="; expires="+o.toUTCString()),document.cookie=e+"="+(t||"")+i+"; path=/; SameSite=Strict"}function getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return null}function eraseCookie(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}